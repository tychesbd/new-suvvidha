"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[403],{2403:(e,t,s)=>{s.r(t),s.d(t,{default:()=>_});var n=s(5043),a=s(6446),i=s(5865),l=s(3336),r=s(6213),o=s(2420),c=s(3845),d=s(1637),u=s(9650),h=s(1806),x=s(4882),m=s(8076),g=s(3460),j=s(1906),p=s(35),A=s(6600),v=s(5316),b=s(8903),y=s(5795),k=s(2143),f=s(9347),C=s(4535),S=s(9974),N=s(2177),w=s(9466),B=s(579);const I=(0,C.Ay)(o.A)((e=>{let{theme:t}=e;return{fontWeight:"bold",backgroundColor:"dark"===t.palette.mode?t.palette.grey[800]:t.palette.grey[100]}})),z=(0,C.Ay)(c.A)((e=>{let{theme:t,status:s}=e,n=t.palette.info.main,a=t.palette.info.light;return"completed"===s?(n=t.palette.success.main,a=t.palette.success.light):"cancelled"===s?(n=t.palette.error.main,a=t.palette.error.light):"in-progress"===s?(n=t.palette.warning.main,a=t.palette.warning.light):"pending"===s&&(n=t.palette.info.main,a=t.palette.info.light),{color:n,backgroundColor:a,fontWeight:"bold","& .MuiChip-label":{textTransform:"capitalize"}}})),W=e=>{let{icon:t,label:s,value:n}=e;return(0,B.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[(0,B.jsx)(a.A,{sx:{color:"primary.main",mr:2},children:t}),(0,B.jsxs)(a.A,{children:[(0,B.jsx)(i.A,{variant:"caption",color:"text.secondary",children:s}),(0,B.jsx)(i.A,{variant:"body1",children:n})]})]})},F=()=>{const[e,t]=(0,n.useState)([]),[s,c]=(0,n.useState)(!0),[C,F]=(0,n.useState)(null),[_,U]=(0,n.useState)(!1),[L,O]=(0,n.useState)(null),[P,Y]=(0,n.useState)(""),[$,D]=(0,n.useState)("");(0,n.useEffect)((()=>{(async()=>{try{const e=JSON.parse(localStorage.getItem("userInfo"));if(!e||!e.token)return F("You must be logged in to view bookings"),void c(!1);const s={headers:{Authorization:`Bearer ${e.token}`}},n=await r.A.get("/api/bookings/vendor",s);t(n.data),c(!1)}catch(C){var e,s;F((null===(e=C.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)||"Failed to fetch bookings"),c(!1)}})()}),[]);const J=()=>{U(!1),O(null),Y(""),D("")};return s?(0,B.jsxs)(l.A,{elevation:2,sx:{p:3,mt:2,display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,B.jsx)(d.A,{size:40,sx:{mr:2}}),(0,B.jsx)(i.A,{variant:"body1",children:"Loading bookings..."})]}):C?(0,B.jsx)(l.A,{elevation:2,sx:{p:3,mt:2},children:(0,B.jsx)(i.A,{variant:"body1",color:"error",align:"center",children:C})}):0===e.length?(0,B.jsx)(l.A,{elevation:2,sx:{p:3,mt:2},children:(0,B.jsx)(i.A,{variant:"body1",color:"text.secondary",align:"center",children:"You don't have any assigned bookings."})}):(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(u.A,{component:l.A,elevation:2,sx:{mt:2},children:(0,B.jsxs)(h.A,{children:[(0,B.jsx)(x.A,{children:(0,B.jsxs)(m.A,{children:[(0,B.jsx)(I,{children:"Booking ID"}),(0,B.jsx)(I,{children:"Customer"}),(0,B.jsx)(I,{children:"Service"}),(0,B.jsx)(I,{children:"Location"}),(0,B.jsx)(I,{children:"Status"}),(0,B.jsx)(I,{align:"center",children:"Action"})]})}),(0,B.jsx)(g.A,{children:e.map((e=>(0,B.jsxs)(m.A,{hover:!0,children:[(0,B.jsxs)(o.A,{children:[e._id.substring(0,8),"..."]}),(0,B.jsx)(o.A,{children:e.customer.name}),(0,B.jsx)(o.A,{children:e.serviceName}),(0,B.jsx)(o.A,{children:e.customer.location}),(0,B.jsx)(o.A,{children:(0,B.jsx)(z,{label:e.status,status:e.status,size:"small"})}),(0,B.jsx)(o.A,{align:"center",children:(0,B.jsx)(j.A,{variant:"outlined",color:"primary",size:"small",onClick:()=>(e=>{O(e),Y(e.status),D(e.statusNote||""),U(!0)})(e),disabled:"cancelled"===e.status,children:"Update Status"})})]},e._id)))})]})}),(0,B.jsxs)(p.A,{open:_,onClose:J,maxWidth:"sm",fullWidth:!0,children:[(0,B.jsx)(A.A,{children:"Update Booking Status"}),(0,B.jsx)(v.A,{children:L&&(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)(a.A,{sx:{mb:3,mt:2},children:[(0,B.jsx)(i.A,{variant:"subtitle1",gutterBottom:!0,children:"Booking Details:"}),(0,B.jsxs)(b.Ay,{container:!0,spacing:2,children:[(0,B.jsxs)(b.Ay,{item:!0,xs:12,md:6,children:[(0,B.jsx)(W,{icon:(0,B.jsx)(N.A,{}),label:"Customer Name",value:L.customer.name}),(0,B.jsx)(W,{icon:(0,B.jsx)(w.A,{}),label:"Phone Number",value:L.customer.phoneNumber})]}),(0,B.jsx)(b.Ay,{item:!0,xs:12,md:6,children:(0,B.jsx)(W,{icon:(0,B.jsx)(S.A,{}),label:"Location",value:L.customer.location})})]})]}),(0,B.jsxs)(y.A,{select:!0,label:"Update Status",value:P,onChange:e=>Y(e.target.value),fullWidth:!0,margin:"normal",required:!0,children:[(0,B.jsx)(k.A,{value:"in-progress",children:"In Progress"}),(0,B.jsx)(k.A,{value:"completed",children:"Completed"}),(0,B.jsx)(k.A,{value:"cancelled",children:"Cancelled"})]}),(0,B.jsx)(y.A,{label:"Status Note (Optional)",value:$,onChange:e=>D(e.target.value),fullWidth:!0,margin:"normal",multiline:!0,rows:3,placeholder:"Add any notes about this status update"})]})}),(0,B.jsxs)(f.A,{children:[(0,B.jsx)(j.A,{onClick:J,color:"inherit",children:"Cancel"}),(0,B.jsx)(j.A,{onClick:async()=>{if(L&&P){c(!0);try{const s=JSON.parse(localStorage.getItem("userInfo"));if(!s||!s.token)return F("You must be logged in to update booking status"),void c(!1);const n={headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.token}`}},{data:a}=await r.A.put(`/api/bookings/${L._id}/vendor-status`,{status:P,statusNote:$},n),i=e.map((e=>e._id===L._id?{...e,status:P,statusNote:$}:e));t(i),c(!1),J()}catch(C){var s,n;F((null===(s=C.response)||void 0===s||null===(n=s.data)||void 0===n?void 0:n.message)||"Failed to update booking status"),c(!1)}}},color:"primary",variant:"contained",disabled:!P||s,children:s?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(d.A,{size:20,sx:{mr:1},color:"inherit"}),"Processing..."]}):"Update Status"})]})]})]})},_=()=>(0,B.jsxs)(a.A,{children:[(0,B.jsx)(i.A,{variant:"h4",gutterBottom:!0,children:"My Assigned Bookings"}),(0,B.jsx)(i.A,{variant:"subtitle1",color:"text.secondary",paragraph:!0,children:"View and manage bookings assigned to you by admin"}),(0,B.jsx)(l.A,{elevation:0,sx:{p:0},children:(0,B.jsx)(F,{})})]})}}]);
//# sourceMappingURL=403.7a11d87a.chunk.js.map